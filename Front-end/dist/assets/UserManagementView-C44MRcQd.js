import{r as m,a as k,h as D,E as V,l as A,i as f,o as v,w as o,b as p,d as a,f as c,e as l,k as B,bH as I,C as N,D as T,t as E}from"./index-DX3WRIvF.js";import{L}from"./Layout-Caa_pSpe.js";import{u as R,a as j}from"./userStore-B-BM9dwW.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"user-management-container"},F={class:"user-management-content"},G={class:"operation-bar"},J={class:"pagination-container"},K={__name:"UserManagementView",setup(O){const g=R(),i=m([]),u=m(!1),n=k({currentPage:1,pageSize:10,total:0});D(async()=>{g.initialized||await g.initializeUserInfo(),await _()});const _=async()=>{u.value=!0;try{const e=await j.getAllUsers();i.value=Array.isArray(e)?e:[],n.total=i.value.length,console.log("获取到的用户列表:",i.value)}catch(e){console.error("获取用户列表失败:",e),V.error("获取用户列表失败，请稍后重试"),i.value=[]}finally{u.value=!1}},y=A(()=>{const e=(n.currentPage-1)*n.pageSize,t=e+n.pageSize;return i.value.slice(e,t)}),b=e=>{n.currentPage=e},w=e=>{n.pageSize=e,n.currentPage=1},z=e=>({admin:"管理员",user:"普通用户"})[e]||"未知角色",h=e=>({admin:"danger",user:"success"})[e]||"info";return(e,t)=>{const S=l("el-icon"),d=l("el-button"),r=l("el-table-column"),C=l("el-tag"),U=l("el-table"),x=l("el-pagination"),M=l("el-card"),P=T("loading");return v(),f(L,null,{default:o(()=>[p("div",q,[t[5]||(t[5]=p("h1",null,"用户管理",-1)),p("div",F,[p("div",G,[a(d,{type:"primary",onClick:_},{default:o(()=>[a(S,null,{default:o(()=>[a(B(I))]),_:1}),t[2]||(t[2]=c(" 刷新用户列表 ",-1))]),_:1})]),a(M,{class:"user-table-card"},{default:o(()=>[N((v(),f(U,{data:y.value,style:{width:"100%"},stripe:""},{default:o(()=>[a(r,{prop:"id",label:"用户ID",width:"80"}),a(r,{prop:"username",label:"用户名",width:"120"}),a(r,{prop:"nickname",label:"昵称",width:"120"}),a(r,{prop:"email",label:"邮箱"}),a(r,{prop:"phone",label:"手机号",width:"120"}),a(r,{prop:"role",label:"角色",width:"80"},{default:o(s=>[a(C,{type:h(s.row.role)},{default:o(()=>[c(E(z(s.row.role)),1)]),_:2},1032,["type"])]),_:1}),a(r,{label:"操作",width:"150",fixed:"right"},{default:o(s=>[a(d,{size:"small",type:"primary"},{default:o(()=>[...t[3]||(t[3]=[c("编辑",-1)])]),_:1}),a(d,{size:"small",type:"danger"},{default:o(()=>[...t[4]||(t[4]=[c("禁用",-1)])]),_:1})]),_:1})]),_:1},8,["data"])),[[P,u.value]]),p("div",J,[a(x,{"current-page":n.currentPage,"onUpdate:currentPage":t[0]||(t[0]=s=>n.currentPage=s),"page-size":n.pageSize,"onUpdate:pageSize":t[1]||(t[1]=s=>n.pageSize=s),"page-sizes":[5,10,20,50],layout:"total, sizes, prev, pager, next, jumper",total:n.total,onSizeChange:w,onCurrentChange:b},null,8,["current-page","page-size","total"])])]),_:1})])])]),_:1})}}},Z=H(K,[["__scopeId","data-v-1682a83f"]]);export{Z as default};
