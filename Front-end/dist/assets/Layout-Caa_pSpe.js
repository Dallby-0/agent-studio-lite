import{bI as j,u as T,r as U,l as M,e as v,c as a,o as e,m as c,b as l,t as u,F as R,j as z,s as _,i as p,w as d,bJ as D,d as m,bK as w,k as H,bL as E,bM as O,f as V,bN as W,bO as K,E as N}from"./index-DX3WRIvF.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as q}from"./userStore-B-BM9dwW.js";const J={class:"sidebar"},G={key:0,class:"sidebar-header"},P={key:0,class:"logo-container"},Q={key:0,class:"logo-image"},X=["src","alt"],Y={key:1,class:"logo-text"},Z={key:1,class:"sidebar-title"},ee={class:"sidebar-nav"},te={class:"nav-list"},se=["onClick"],oe={key:0,class:"nav-icon"},ae={key:1},ne={class:"nav-text"},le={key:1,class:"nav-item-wrapper"},re=["onClick"],ce={key:0,class:"nav-icon"},de={key:1},ue={class:"nav-text"},ie=["onClick"],fe={class:"submenu-text"},he={key:1,class:"sidebar-footer"},pe={__name:"Sidebar",props:{menuItems:{type:Array,default:()=>[]},collapsed:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},logo:{type:String,default:"ðŸ¤–"},title:{type:String,default:"Agent Studio Lite"},hasFooter:{type:Boolean,default:!1},activeClass:{type:String,default:"active"}},emits:["toggle","item-click"],setup(t,{emit:C}){const y=j(),i=T(),A=t,h=U([]),f=C;M(()=>A.collapsed);const $=o=>typeof o=="string"||typeof o=="object"&&o!==null&&"name"in o,r=o=>o.path?!!(y.path===o.path||o.path.endsWith("/")&&y.path.startsWith(o.path)):!1,S=o=>{h.value.includes(o)?h.value=h.value.filter(g=>g!==o):h.value.push(o)},k=o=>{f("item-click",o),o.path&&i.push(o.path),o.click&&typeof o.click=="function"&&o.click()};return(o,g)=>{const I=v("el-icon"),L=v("ArrowDown");return e(),a("div",J,[t.showHeader?(e(),a("div",G,[t.logo?(e(),a("div",P,[typeof t.logo=="string"&&t.logo.includes("://")?(e(),a("div",Q,[l("img",{src:t.logo,alt:t.title||"Logo"},null,8,X)])):(e(),a("div",Y,u(t.logo),1))])):c("",!0),t.title?(e(),a("h2",Z,u(t.title),1)):c("",!0)])):c("",!0),l("nav",ee,[l("ul",te,[(e(!0),a(R,null,z(t.menuItems,(s,b)=>(e(),a("li",{key:b,class:_(["nav-item",{active:r(s),"has-children":s.children&&s.children.length>0}])},[!s.children||s.children.length===0?(e(),a("div",{key:0,class:"nav-link",onClick:n=>k(s)},[s.icon?(e(),a("div",oe,[$(s.icon)?(e(),p(I,{key:0},{default:d(()=>[(e(),p(D(s.icon)))]),_:2},1024)):(e(),a("span",ae,u(s.icon),1))])):c("",!0),l("span",ne,u(s.label),1)],8,se)):(e(),a("div",le,[l("div",{class:"nav-link nav-parent",onClick:n=>S(b)},[s.icon?(e(),a("div",ce,[$(s.icon)?(e(),p(I,{key:0},{default:d(()=>[(e(),p(D(s.icon)))]),_:2},1024)):(e(),a("span",de,u(s.icon),1))])):c("",!0),l("span",ue,u(s.label),1),m(I,{class:"chevron-icon"},{default:d(()=>[m(L,{rotate:h.value.includes(b)?180:0},null,8,["rotate"])]),_:2},1024)],8,re),l("ul",{class:_(["submenu",{expanded:h.value.includes(b)}])},[(e(!0),a(R,null,z(s.children,(n,B)=>(e(),a("li",{key:B,class:_(["submenu-item",{active:r(n)}])},[l("div",{class:"submenu-link",onClick:F=>k(n)},[l("span",fe,u(n.label),1)],8,ie)],2))),128))],2)]))],2))),128))])]),t.hasFooter?(e(),a("div",he,[w(o.$slots,"footer",{},void 0,!0)])):c("",!0)])}}},me=x(pe,[["__scopeId","data-v-0269fb4c"]]),ve={class:"app-header"},ge={class:"header-left"},be={key:1,class:"breadcrumb-container"},_e={key:2,class:"page-title"},ye={class:"header-center"},ke={class:"header-right"},Ie={class:"header-actions"},we={class:"user-info"},$e={key:0,class:"user-details"},Se={class:"user-name"},Ce={key:0,class:"user-role"},Ae={__name:"AppHeader",props:{pageTitle:{type:String,default:""},breadcrumbRoutes:{type:Array,default:()=>[]},showBreadcrumb:{type:Boolean,default:!1},showMobileMenuBtn:{type:Boolean,default:!0},userInfo:{type:Object,default:()=>({name:"",role:"",avatar:""})},showUserDetails:{type:Boolean,default:!0},avatarSize:{type:[Number,String],default:36},defaultActions:{type:Array,default:()=>[]},userMenuItems:{type:Array,default:()=>[{label:"é€€å‡ºç™»å½•",divided:!0,action:"logout"}]}},emits:["toggle-sidebar","user-menu-click","logout"],setup(t,{emit:C}){const y=t,i=C,A=M(()=>{var r;return(r=y.userInfo)!=null&&r.name?y.userInfo.name.charAt(0).toUpperCase():"U"}),h=r=>{i("user-menu-click",r),r.action==="logout"&&$(),r.click&&typeof r.click=="function"&&r.click()},f=U(null),$=()=>{i("logout")};return(r,S)=>{const k=v("el-button"),o=v("el-icon"),g=v("el-breadcrumb"),I=v("el-avatar"),L=v("el-dropdown-item"),s=v("el-dropdown-menu"),b=v("el-dropdown");return e(),a("header",ve,[l("div",ge,[t.showMobileMenuBtn?(e(),p(k,{key:0,class:"mobile-menu-btn",onClick:S[0]||(S[0]=n=>r.$emit("toggle-sidebar")),type:"text",size:"large",icon:"Menu"})):c("",!0),t.showBreadcrumb?(e(),a("div",be,[m(g,{separator:"/",routes:t.breadcrumbRoutes},{separator:d(()=>[m(o,null,{default:d(()=>[m(H(E))]),_:1})]),_:1},8,["routes"])])):c("",!0),t.pageTitle?(e(),a("h1",_e,u(t.pageTitle),1)):c("",!0)]),l("div",ye,[w(r.$slots,"center",{},void 0,!0)]),l("div",ke,[l("div",Ie,[w(r.$slots,"actions",{},void 0,!0),t.defaultActions.length>0?(e(!0),a(R,{key:0},z(t.defaultActions,(n,B)=>(e(),p(k,{key:B,type:n.type||"text",size:n.size||"large",icon:n.icon,class:_(["action-btn",n.class]),disabled:n.disabled,onClick:F=>n.click&&n.click(),title:n.title},O({_:2},[n.badge?{name:"default",fn:d(()=>[l("span",{class:_(["action-badge",n.badgeClass])},u(n.badge),3)]),key:"0"}:void 0]),1032,["type","size","icon","class","disabled","onClick","title"]))),128)):c("",!0)]),t.userInfo?(e(),p(b,{key:0,trigger:"click",onCommand:h,class:"user-dropdown",ref_key:"dropdownRef",ref:f},{dropdown:d(()=>[m(s,null,{default:d(()=>[(e(!0),a(R,null,z(t.userMenuItems,(n,B)=>(e(),p(L,{key:B,divided:n.divided,command:n},{default:d(()=>[n.icon?(e(),p(o,{key:0},{default:d(()=>[(e(),p(D(n.icon)))]),_:2},1024)):c("",!0),l("span",null,u(n.label),1)]),_:2},1032,["divided","command"]))),128))]),_:1})]),default:d(()=>[l("div",we,[m(I,{size:t.avatarSize,src:t.userInfo.avatar,class:_("user-avatar")},{default:d(()=>[V(u(A.value),1)]),_:1},8,["size","src"]),t.showUserDetails?(e(),a("div",$e,[l("div",Se,u(t.userInfo.name),1),t.userInfo.role?(e(),a("div",Ce,u(t.userInfo.role),1)):c("",!0)])):c("",!0),t.showUserDetails?(e(),p(o,{key:1,class:"chevron-icon"},{default:d(()=>[m(H(W))]),_:1})):c("",!0)])]),_:1},512)):c("",!0)])])}}},Be=x(Ae,[["__scopeId","data-v-396dd157"]]),Le={class:"app-layout"},Me={key:0,class:"app-header"},Re={class:"app-content"},ze={key:1,class:"app-footer"},De={__name:"Layout",props:{hasHeader:{type:Boolean,default:!0},hasFooter:{type:Boolean,default:!1},collapsed:{type:Boolean,default:!1},sidebarWidth:{type:String,default:"250px"},sidebarCollapsedWidth:{type:String,default:"64px"},userInfo:{type:Object,default:null}},emits:["toggle-sidebar","update:collapsed","logout"],setup(t,{expose:C,emit:y}){const i=q(),A=T(),h=t,f=U(h.collapsed),$=M(()=>h.userInfo||{name:i.displayName,role:i.role,avatar:i.userInfo.avatar||""}),r=[{label:"é¦–é¡µ",icon:"House",path:"/home"},{label:"å¯¹è¯ä¸­å¿ƒ",icon:"ChatDotRound",path:"/chat"},{label:"ä»»åŠ¡ç®¡ç†",icon:"List",path:"/tasks"},{label:"Agenté…ç½®",icon:"Key",path:"/agents"},{label:"èµ„æºåº“",icon:"Document",path:"/knowledge"},{label:"å·¥ä½œæµ",icon:"Connection",path:"/workflows"},{label:"ç³»ç»Ÿè®¾ç½®",icon:"Tools",path:"/settings"}],S=[{label:"ç”¨æˆ·ç®¡ç†",icon:"User",path:"/admin",requiresAdmin:!0}],k=M(()=>{const s=[...r];return(i.isAdmin||localStorage.getItem("userRole")==="admin")&&s.push(...S),s});K(()=>[i.role,localStorage.getItem("userRole")],()=>{console.log("ç”¨æˆ·è§’è‰²å¯èƒ½å·²å˜æ›´ï¼Œèœå•å°†è‡ªåŠ¨æ›´æ–°:",i.role)});const o=y,g=()=>{f.value=!f.value,o("toggle-sidebar",f.value),o("update:collapsed",f.value)},I=async()=>{try{i.clearUserInfo(),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userInfo"),localStorage.removeItem("username"),Object.keys(localStorage).forEach(s=>{(s.toLowerCase().includes("user")||s.toLowerCase().includes("auth")||s.toLowerCase().includes("token"))&&localStorage.removeItem(s)}),N.success("é€€å‡ºç™»å½•æˆåŠŸ"),A.push("/"),o("logout")}catch(s){console.error("é€€å‡ºç™»å½•å¤±è´¥:",s),N.error("é€€å‡ºç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•")}};return C({toggleSidebar:g,isSidebarCollapsed:f}),(s,b)=>(e(),a("div",Le,[l("aside",{class:_(["app-sidebar",{collapsed:f.value}])},[w(s.$slots,"sidebar",{},()=>[m(me,{menuItems:k.value,collapsed:f.value,onToggle:g},null,8,["menuItems","collapsed"])],!0)],2),l("main",{class:_(["app-main",{"sidebar-collapsed":f.value}])},[t.hasHeader?(e(),a("header",Me,[w(s.$slots,"header",{},()=>[m(Be,{userInfo:$.value,onToggleSidebar:g,onLogout:I},null,8,["userInfo"])],!0)])):c("",!0),l("div",Re,[w(s.$slots,"default",{},void 0,!0)]),t.hasFooter?(e(),a("footer",ze,[w(s.$slots,"footer",{},void 0,!0)])):c("",!0)],2)]))}},Ne=x(De,[["__scopeId","data-v-4279c19f"]]);export{Ne as L};
