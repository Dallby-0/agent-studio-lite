# 工作流设计器端口和连线改进计划

## 需求分析

用户要求改进工作流设计器的节点连线功能，主要包括：

1. 节点两侧正中间添加朝右的三角箭头作为端口
2. 节点间连线从箭头出发并抵达箭头
3. 支持从右箭头拖拽到左箭头进行连线
4. 分支节点具有多组箭头，且可对箭头组进行增减

## 实现方案

### 1. 修改节点模板，添加端口

* 在节点左侧添加输入端口（左箭头）

* 在节点右侧添加输出端口（右箭头）

* 端口位于节点垂直居中位置

* 箭头样式为朝右的三角形

### 2. 实现端口拖拽连线功能

* 监听右箭头的鼠标按下事件，开始连线

* 监听鼠标移动事件，实时更新连线预览

* 监听鼠标释放事件，完成连线

* 确保只能从右箭头（输出端口）连接到左箭头（输入端口）

### 3. 修改连线逻辑

* 将连线起始位置改为从输出端口出发

* 将连线结束位置改为抵达输入端口

* 更新连接线的绘制逻辑

### 4. 分支节点特殊处理

* 为分支节点添加多组端口

* 支持添加新的端口组

* 支持删除现有端口组

* 每组端口包含输入和输出端口

* 分支节点包括普通分支和大模型分支

### 5. 添加端口组管理

* 在属性面板中添加端口组管理功能

* 支持编辑端口组属性

* 支持配置端口组的条件表达式

## 修改文件

* **WorkflowDesigner.vue**：核心设计器组件，添加端口和改进连线逻辑

## 技术要点

* 使用SVG实现箭头和连线

* 实现拖拽交互

* 支持动态增减端口组

* 确保性能和用户体验

## 预期效果

* 节点两侧显示箭头端口

* 可从右箭头拖拽到左箭头连线

* 分支节点支持多组箭头

* 连线从箭头出发并抵达箭头

* 支持对箭头组进行增减操作

